<!DOCTYPE html>
<html>
<head>
    <title>Test Image API</title>
</head>
<body>
    <h1>Test Image Generation API</h1>
    <button onclick="testImageGeneration()">Generate Test Image</button>
    <div id="result"></div>
    <div id="image-container"></div>

    <script>
        async function testImageGeneration() {
            const resultDiv = document.getElementById('result');
            const imageContainer = document.getElementById('image-container');
            
            resultDiv.innerHTML = 'Generating image...';
            
            try {
                const response = await fetch('/api/image/generate', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        prompt: 'A magical castle in the clouds',
                        style: 'cartoon'
                    })
                });

                if (!response.ok) {
                    const errorData = await response.json();
                    throw new Error(errorData.message || 'Failed to generate image');
                }

                const data = await response.json();
                
                if (data.success && data.result && data.result.url) {
                    resultDiv.innerHTML = `
                        <p>✅ Success!</p>
                        <p>Image ID: ${data.result.id}</p>
                        <p>URL: <a href="${data.result.url}" target="_blank">${data.result.url}</a></p>
                    `;
                    
                    imageContainer.innerHTML = `<img src="${data.result.url}" alt="Generated image" style="max-width: 500px; border: 1px solid #ccc;">`;
                } else {
                    resultDiv.innerHTML = '❌ Invalid response structure: ' + JSON.stringify(data);
                }
            } catch (error) {
                resultDiv.innerHTML = '❌ Error: ' + error.message;
                console.error('Image generation failed:', error);
            }
        }
    </script>
</body>
</html>